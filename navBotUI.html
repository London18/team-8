<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="styles.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

</head>
<body>

<div id="all">
	<div id="header">
		<h5>NavBot</h5>
	</div>
	<div id="messages">
		<p class="botPara">Macs: How can I help you?</p>
	</div>
	<div id="input">
		<input id="userIn" type="text" name="userInput"><input type="button" id="myButton" onclick="youAppend()" value="Send"/>
		<button id="yesButton"  onclick='botAppend("Glad I could help!")' style="display: none">Yes</button>
		<button id="noButton"  onclick='botAppend("Please can you explain your problem a little more?")' style="display: none">No</button>
	</div>
</div>
<script type="text/javascript">
    function youAppend() {
        //var newText = document.createTextNode(document.getElementById('userIn').value);
        //int count = 0;
        //var para = document.getElementById("messagePara");

        //creates new paragraph
        var newParagraph = document.createElement('textarea');
        newParagraph.className = "youPara";

        //inserts user's text
        newParagraph.textContent = document.getElementById('userIn').value;
        newParagraph.prepend("You: ");

        //find the div to put it in
        var div = document.getElementById("messages");

        //append the new message
        div.appendChild(newParagraph);

        // autoGrow(newParagraph);

        userIn.value="";

        div.scrollTop = div.scrollHeight

        document.getElementById(userIn.id).focus();
        document.getElementById(userIn.id).select();

        query(document.getElementById('userIn').value);

        //put the thing=== that get files from java and also get response from them
        // sendToJava();
        var resultPara = document.createElement('p');
        // var textToPrint = getFromJava();
        botAppend(resultPara.id);

        // printButton();
    }

    function botAppend(message) {


        document.getElementById('yesButton').style.display = 'none';
        document.getElementById('noButton').style.display = 'none';

        if(message === "Glad I could help!") {
            count = 0;

            //ask if they want to save the conversation and files
            //if no then tell java then they delete
            //if yes then send the email that the use inputs
        }

        //count += 1;
        //var newText = document.createTextNode(document.getElementById('userIn').value);
        //var para = document.getElementById("messagePara");


        //creates new paragraph
        var newParagraph = document.createElement('p');
        newParagraph.className = "botPara";

        //inserts user's text
        newParagraph.textContent = message;
        newParagraph.prepend("Macs: ");

        //find the div to put it in
        var div = document.getElementById("messages");

        //append the new message
        div.appendChild(newParagraph)

        div.scrollTop = div.scrollHeight

        document.getElementById(userIn.id).focus();
        document.getElementById(userIn.id).select();


    }

    function query(input) {
        var stringQuery = "http://localhost:8080/chat?userInput="+input;

        $(document).ready(function() {
            $.ajax({
                url: stringQuery
            }).then(function(userInput) {
                botAppend(userInput);
            });
        });
    }
</script>
</body>
</html>